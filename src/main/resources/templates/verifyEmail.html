<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{fragments/layout}">
<head>
    <title>Verify Email</title>
</head>
<body>
<div layout:fragment="content" th:remove="tag">
    <div th:if="${error}" class="error-summary" role="alert" aria-labelledby="error-summary-heading"
         tabindex="-1">
        <th:block th:switch="${error}">
            <h2 class="heading-medium error-summary-heading center noMargin" id="errors">
                <th:block th:case="'format'">Enter your email address in 'name@domain.ext' format</th:block>
                <th:block th:case="'characters'">Email address can only contain the following characters: 0-9A-Za-z@.'_-
                </th:block>
                <th:block th:case="'domain'">Email addresses must be to an approved email domain</th:block>
                <th:block th:case="*">An error occurred during sending the verification email. Please try again.</th:block>
            </h2>
        </th:block>
    </div>
    <div th:unless="${error}" role="alert" tabindex="-1">
        <h1 class="heading-large">
            Email Address Verification
        </h1>
        <br>
        So that you can reset your own password in future and to send you emails, please could you verify your email
        address.
    </div>
    <div class="pure-g">
        <div class="pure-u-1 pure-u-md-1-1">
            <div th:if="${! #lists.isEmpty(candidates)}">
                We have found the following email addresses. Please select one or enter a different one in the box below
                <ul>
                    <li th:each="candidate, iter: ${candidates}">
                        <input type="radio" th:id="${'candidate' + iter.index}" name="candidate"
                               th:value="${candidate}"/>
                        <label th:for="${'candidate' + iter.index}" th:text="${candidate}">
                    </li>
                </ul>
            </div>
            <div th:if="${email}">
                <h3>
                    We have found an existing email address that hasn't been verified yet. Please correct the email
                    address if necessary and we will then send another verification email.
                </h3>
            </div>
            <br>
            <div class="pure-u-1 pure-u-md-1-3">
                <form class="form" th:action="@{/verify-email}" method="POST" id="loginForm">
                    <div class="form-group">
                        <label class="form-label" for="email">Email</label>
                        <input class="form-control" id="email" name="email" type="text"
                               data-element-id="email" autofocus="autofocus" th:value="${email}">
                    </div>
                    <div class="pure-u-1 inlineButtons paddingBottom smallPaddingTop">
                        <input type="submit" class="button largeMarginBottom" id="submit" role="button"
                               data-element-id="continue-button" value="Verify email">
                        <a class="button button-secondary" role="button" id="cancel"
                           th:href="@{/verify-email-continue}">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>
</html>
